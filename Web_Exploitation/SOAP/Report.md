# SOAP
## Description
>The web project was rushed and no security assessment was done. Can you read the /etc/passwd file? [Web Portal](http://saturn.picoctf.net:55566/)

---
Visiting the page, we see a page with 3 cards, and an interactable `Details` button:

![[Pasted image 20230327205408.png]]

When we watch Firefox's Network Monitor and click a detail, we see a post method sent:

![[Pasted image 20230327205640.png]]

The request payload is in xml format, potentially leading to XXE (XML external entity) injection. We can try a simple payload described in [portswigger's post](https://portswigger.net/web-security/xxe) on the topic:

```
`<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]> <stockCheck><productId>&xxe;</productId></stockCheck>`
```

modifying our own payload:
```
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [ <!ENTITY abc SYSTEM "file:///etc/passwd"> ]><data><ID>&abc;</ID></data>
```

We can resend our request using Firefox's Network Manager again, and replace the body contents with our newly modified payload. In the response tab, we see the contents of `/etc/passwd` as well as our flag:

![[Pasted image 20230327210246.png]]

picoCTF{XML_3xtern@l_3nt1t1ty_55662c16}

In an interesting twist of annoyance, the xxe injection fails if you use the entity term 'xxe', as is done in portswigger's example.  After renaming the entity to 'abc', the xxe exploit worked effortlessly.